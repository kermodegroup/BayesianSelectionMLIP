# Si Surfaces Documentation

This directory contains the scripts required to fully reproduce the publication, provided the `BayesianSelection` package has been correctly installed with Python and Julia dependancies.

## Structure of the Directory
### .py files
`build_datasets.py` : Selects structures from `Si_2018_Dataset.xyz` by config type, to generate the "Core" dataset (`Si_Core_Data.xyz`), the dataset of candidate surface structures (`Si_Surface_Structs.xyz`), and the "Total" dataset (`Si_Total_Dataset.xyz`)

`generate_sampled_datasets.py` : Run the sampling to select sub datasets for different numbers of structures sampled.

`run_ace_fits.py` : Call Julia to fit ACE models to each sub dataset.

`run_gap_fits.py` : Fit small GAP models to each sub dataset.

`sampling_config.py` : Contains a config dictionary which parameterises the sampling descriptor & methodology combinations tested.

`si_descriptors.py` : Defined the specific parameterisations of ACE and MACE descriptors tested.

`Tests/Dataset_Errs.py` : Test script for the Dataset RMSE data

`Tests/plot_config.py` : Plot configuration tools, including which descriptor/methodology combinations to plot for each plot type

`Tests/plot_Dataset_Errs.py` : Generate the Dataset RMSE plots (Figs. 1 & 3)

`Tests/plot_Surfaces.py` : Generate the Surface Formation Energy plots (Figs. 2 & 4)

`Tests/si_models.py` : Helper functions for initialising the trained models

`Tests/Surface.py` : Test script for the Surface Formation Energy data
 
### .xyz files
`Si_2018_Dataset.xyz` : Original 2018 Si Dataset, in full. See [https://doi.org/10.1103/PhysRevX.8.041048](https://doi.org/10.1103/PhysRevX.8.041048)

`Si_Core_Data.xyz` : "Core" dataset, consisting of an isolated atom structure and diamond bulk structures

`Si_Surface_Structures.xyz` : Dataset of candidate surface structures used for sampling. Contains structures targetting the (001), (110), and (111) surfaces.

`Si_Total_Dataset.xyz` : "Total" dataset, "Core" + candidate set.

### Subdirectories
`AL_Datasets/` : Stores all datasets generated by `generate_sampled_datasets.py`.

`Models/` : Stores all MLIP models. `Models/CoreMACE` stores the "Core" MACE model, `Models/TotalMACE` stores the "Total" MACE model. ACEs trained by `run_ace_fits.py` will be stored in `Models/ACEs`.

`Original_Dataset/` : The original 2018 Si Dataset, separated out into separate `.xyz` files by config type.

`Plots/` : Plots directory. Created when running either plot script.

`Tests/` : Scripts to run the tests and plot results.

`Test_Results/` : Results directiory containing `.json` files. Created when running either test script

## Reproducing the Publication
### 1. Reproducing the Sampled Dataset
Use `generate_sampled_datasets.py` to sample from the candidate dataset (`Si_Surface_Structs.xyz`) and construct the sampled datasets for each method. Modify the `methods` list with items from `sampling_config.method_params.keys()` to change which methods are used in sampling. The datasets will be saved in `AL_Datasets/{method}`.

### 2. Refitting the ACE Models
Use `run_ace_fits.py` to train ACE models on each of the sampled datasets. Modify the `methods` list similarly to `generate_sampled_datasets.py` to control which models are generated. Models will be saved in `Models/ACEs/{method}`.


### 3. Reproducing the Test Results
`cd` into the `Tests` directory to access the model tests.

Run `Surfaces.py` to generate results for surface formation energy, again modifying the `methods` list to control which models are tested. Run `plot_Surfaces.py` to generate the plots similar to Figs. 2 & 4. The results of `Surfaces.py` are saved in `Tests/Results/{method}`, and the plots from `plot_Surfaces.py` will be saved in `Plots/`.

Run `Dataset_Errs.py` to generate results for the Dataset RMSEs on energies and forces, again modifying `methods`. Run `plot_Dataset_Errs.py` to plot results similar to Figs. 1 & 3, as well as similar breakdowns by config type. The results of `Dataset_Errs.py` are saved in `Tests/Results/{method}`, and the plots from `plot_Dataset_Errs.py` will be saved in `Plots/Dataset_Errs`.